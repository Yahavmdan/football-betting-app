<div class="home-container">
  <!-- Navigation Tabs -->
  <div class="dashboard-tabs">
    <a routerLink="/home" class="dashboard-tab active">
      <span>{{ 'nav.matches' | translate }}</span>
    </a>
    <a routerLink="/groups" class="dashboard-tab">
      <span>{{ 'nav.groups' | translate }}</span>
    </a>
    <a routerLink="/profile" class="dashboard-tab profile-tab">
      <img *ngIf="currentUser?.profilePicture"
           [src]="currentUser!.profilePicture!"
           alt="Profile"
           class="tab-profile-picture">
      <span *ngIf="!currentUser?.profilePicture" class="tab-profile-placeholder">
        {{ currentUser?.username?.charAt(0)?.toUpperCase() }}
      </span>
      <span class="profile-tab-name">{{ currentUser?.username }}</span>
    </a>
  </div>

  <!-- Header -->
  <div class="home-header">
    <h1>{{ 'home.title' | translate }}</h1>
      <button routerLink="/preferences" class="btn-primary">
          {{ 'home.editPreferences' | translate }}
      </button>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-container">
    <div class="loading-spinner"></div>
  </div>

  <!-- Empty State - No Preferences -->
  <div *ngIf="!loading && !hasPreferences" class="empty-state">
    <div class="empty-icon">
      <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
        <line x1="4" y1="21" x2="4" y2="14"></line>
        <line x1="4" y1="10" x2="4" y2="3"></line>
        <line x1="12" y1="21" x2="12" y2="12"></line>
        <line x1="12" y1="8" x2="12" y2="3"></line>
        <line x1="20" y1="21" x2="20" y2="16"></line>
        <line x1="20" y1="12" x2="20" y2="3"></line>
        <line x1="1" y1="14" x2="7" y2="14"></line>
        <line x1="9" y1="8" x2="15" y2="8"></line>
        <line x1="17" y1="16" x2="23" y2="16"></line>
      </svg>
    </div>
    <h2>{{ 'home.noPreferences' | translate }}</h2>
    <a routerLink="/preferences" class="setup-btn-large">{{ 'home.setupNow' | translate }}</a>
  </div>

  <!-- Matches Content -->
  <div *ngIf="!loading && hasPreferences">
    <!-- Live Matches Section -->
    <div *ngIf="liveMatches.length > 0" class="live-section">
      <div class="section-header live-header">
        <span class="live-indicator"></span>
        <h2>{{ 'home.liveNow' | translate }}</h2>
        <button type="button" class="refresh-btn" (click)="refreshMatches()">
          {{ 'common.refresh' | translate }}
        </button>
      </div>
      <div class="matches-list">
        <app-match-card *ngFor="let match of liveMatches" [match]="match" [context]="matchCardContext"
          [expandedMatchId]="expandedMatchId" [showBettingSection]="false" [showBetIndicators]="false"
          matchIdField="externalApiId"></app-match-card>
      </div>
    </div>

    <!-- League Sections -->
    <div *ngIf="leagueGroups.length > 0">
      <div *ngFor="let leagueGroup of leagueGroups" class="league-section" [class.collapsed]="leagueGroup.isCollapsed">
        <div class="league-header" (click)="toggleLeagueCollapse(leagueGroup)">
          <div class="league-logo-wrapper">
            <img *ngIf="leagueGroup.league.logo" [src]="leagueGroup.league.logo" [alt]="'leagues.' + leagueGroup.league.id | translate" class="league-logo">
          </div>
          <h3>{{ 'leagues.' + leagueGroup.league.id | translate }}</h3>
          <span class="match-count">{{ leagueGroup.matches.length }}</span>
          <span class="collapse-icon" [class.collapsed]="leagueGroup.isCollapsed">â–¼</span>
        </div>
        <div class="matches-list">
          <div class="matches-list-inner">
            <app-match-card *ngFor="let match of leagueGroup.matches" [match]="match" [context]="matchCardContext"
              [expandedMatchId]="expandedMatchId" [showBettingSection]="false" [showBetIndicators]="false"
              matchIdField="externalApiId"></app-match-card>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="leagueGroups.length === 0 && allMatches.length === 0" class="no-matches">
      <p>{{ 'home.noMatches' | translate }}</p>
    </div>
  </div>
</div>
