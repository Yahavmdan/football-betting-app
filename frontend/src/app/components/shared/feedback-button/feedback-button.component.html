<!-- Feedback button (fixed to side, draggable) -->
<button
  *ngIf="!isDialogOpen"
  class="feedback-minimized-btn"
  [class.dragging]="isDragging === 'feedback'"
  [style.top.%]="feedbackY"
  (mousedown)="startDrag($event, 'feedback')"
  (touchstart)="startDrag($event, 'feedback')"
  (click)="onButtonClick('feedback')"
  [attr.aria-label]="t('feedback.reportBug')">
  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
  </svg>
</button>

<!-- Football widget (fixed to side, draggable) -->
<button
  class="football-widget-btn"
  [class.dragging]="isDragging === 'football'"
  [style.top.%]="footballY"
  (mousedown)="startDrag($event, 'football')"
  (touchstart)="startDrag($event, 'football')"
  (click)="onButtonClick('football')"
  [attr.aria-label]="t('matches.title')">
  <span style="font-size: 20px;">âš½</span>
</button>

<!-- Dialog overlay -->
<div *ngIf="isDialogOpen" class="feedback-overlay" (click)="minimize()"></div>

<!-- Dialog -->
<div *ngIf="isDialogOpen" class="feedback-dialog">
  <div class="dialog-header">
    <h3>{{ t('feedback.title') }}</h3>
  </div>

  <div class="dialog-body">
    <p class="dialog-description">{{ t('feedback.description') }}</p>

    <div class="form-group">
      <label for="feedback-message">{{ t('feedback.messageLabel') }}</label>
      <textarea
        id="feedback-message"
        [(ngModel)]="message"
        [placeholder]="t('feedback.messagePlaceholder')"
        rows="4"
        [disabled]="isSubmitting"
        class="feedback-textarea"></textarea>
    </div>

    <!-- Image upload section -->
    <div class="image-upload-section">
      <input
        #fileInput
        type="file"
        accept="image/jpeg,image/jpg,image/png,image/gif,image/webp"
        (change)="onFileSelected($event)"
        class="hidden-file-input">

      <div *ngIf="!imagePreview" class="image-upload-btn" (click)="triggerFileInput()">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
          <circle cx="8.5" cy="8.5" r="1.5"></circle>
          <polyline points="21 15 16 10 5 21"></polyline>
        </svg>
        <span>{{ t('feedback.addImage') }}</span>
      </div>

      <div *ngIf="imagePreview" class="image-preview-container">
        <img [src]="imagePreview" alt="Preview" class="image-preview">
        <button type="button" class="btn-remove-image" (click)="clearImage()" [attr.aria-label]="t('profile.removePicture')">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>
    </div>

  </div>

  <div class="dialog-footer">
    <button
      class="btn-cancel"
      (click)="minimize()"
      [disabled]="isSubmitting">
      {{ t('groups.cancel') }}
    </button>
    <button
      class="btn-submit"
      (click)="submitFeedback()"
      [disabled]="!message.trim() || isSubmitting">
      <span *ngIf="isSubmitting" class="spinner"></span>
      {{ isSubmitting ? t('feedback.sending') : t('feedback.send') }}
    </button>
  </div>
</div>
